---
title: "Traitements des données Météo France SIM2"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Traitements des données Météo France SIM2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(franceclimat)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/flat_traitements_sim2.Rmd: do not edit by hand -->




# def_periode


```{r examples-def_periode}

######################################################
# Exemple avec un data.table

data("ex_data_sim2")

resultat_data_table = def_periode(data = ex_data_sim2,
                       date_col = "DATE",
                       periode = "saison")

######################################################
# Exemple avec un parquet / tbl_lazy

library(DBI)
library(duckdb)
library(dplyr)
library(dbplyr)

file <- system.file("ex_data_sim2.parquet", package = "franceclimat") # Chemin vers le parquet dans le package

con <- dbConnect(duckdb::duckdb()) # Connexion DuckDB en mémoire

tbl_lazy <- tbl(con, sql(sprintf("SELECT * FROM read_parquet('%s')", file))) # Créer une table lazy directement depuis le parquet

resultat_tbl_lazy <- tbl_lazy %>%
  def_periode("DATE", "saison") %>%
  collect()

dbDisconnect(con, shutdown = TRUE)


```




